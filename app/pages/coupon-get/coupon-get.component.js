"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Created by musiwen on 2017/6/17.
 */
var core_1 = require("@angular/core");
var page_1 = require("tns-core-modules/ui/page");
var coupon_1 = require("../../shared/coupon/coupon");
var coupon_service_1 = require("../../shared/coupon/coupon.service");
var logger_service_1 = require("../../service/logger.service");
var router_1 = require("@angular/router");
var BitmapFactory = require("nativescript-bitmap-factory");
var goods_item_1 = require("../../shared/coupon/goods-item");
var CouponGetComponent = (function () {
    function CouponGetComponent(page, couponService, logger, router, activatedRoute) {
        this.page = page;
        this.couponService = couponService;
        this.logger = logger;
        this.router = router;
        this.activatedRoute = activatedRoute;
        this.inputVerify = "";
        this.imageUrl = "res://icon";
        this.verify = "";
    }
    CouponGetComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.page.actionBarHidden = true;
        this.activatedRoute.queryParams.subscribe(function (param) {
            _this.item = new coupon_1.Coupon(param.capture_status, param.coupon_amount, param.coupon_begin_time, param.coupon_end_time, param.coupon_id, param.coupon_name, param.coupon_order_amount, param.coupon_pic, param.coupon_surplus_amount);
            _this.logger.error(param.coupon_end_time);
        });
        this.showVerifyView();
    };
    CouponGetComponent.prototype.submit = function (event) {
        var list = [];
        for (var i = 0; i < 20; i++) {
            list.push(new goods_item_1.GoodsItem(123, "你卖我当你面爱我的阿瓦达瓦大王大伟打完大无多", "https://newretail.iskyshop.com/upload/system/self_goods/2016/01/22/90203d1f-c8dc-42c6-b8d0-017c7ca6d218.jpg_middle.jpg", 998.00));
        }
        this.router.navigate(["/home//couponSuccess"], {
            queryParams: {
                list: JSON.stringify(list),
            },
        });
        // if (this.inputVerify === this.verify) {
        //   this.couponService.getCoupon(this.item.coupon_id.toString())
        //     .subscribe((response) => {
        //       switch (response.status) {
        //         case 1:
        //           break;
        //         case 0:
        //           alert("优惠券已失效");
        //           break;
        //         case -1:
        //           alert("超过领取上限");
        //           break;
        //         case -2:
        //           alert("优惠券数量不足");
        //           break;
        //         case -3:
        //           alert("您的用户等级不够");
        //           break;
        //       }
        //     }, (error) => {
        //       alert("网络错误");
        //     });
        // } else {
        //   alert("请输入正确的验证码");
        // }
    };
    CouponGetComponent.prototype.getRandom = function (max, min) {
        return Math.floor(Math.random() * (max - min + 1) + min);
    };
    CouponGetComponent.prototype.showVerifyView = function () {
        var _this = this;
        var bmp = BitmapFactory.create(96, 40);
        var image2 = this.img.nativeElement;
        bmp.dispose(function () {
            bmp.drawRect({ width: 96, height: 40 }, "0,0", "#ffffff", "#ffffff");
            Math.random();
            var num1 = _this.getRandom(0, 9);
            var num2 = _this.getRandom(0, 9);
            var num3 = _this.getRandom(0, 9);
            var num4 = _this.getRandom(0, 9);
            var num1Size = _this.getRandom(5, 25);
            var num2Size = _this.getRandom(5, 25);
            var num3Size = _this.getRandom(5, 25);
            var num4Size = _this.getRandom(5, 25);
            var num1Top = _this.getRandom(num1Size + 10, 40);
            var num2Top = _this.getRandom(num2Size + 10, 40);
            var num3Top = _this.getRandom(num3Size + 10, 40);
            var num4Top = _this.getRandom(num4Size + 10, 40);
            _this.verify = num1.toString() + num2.toString() + num3.toString() + num4.toString();
            bmp.writeText(num1.toString(), _this.getRandom(0, 20) + "," + num1Top, {
                color: "#db2222",
                size: num1Size,
                name: "impact",
            });
            bmp.writeText(num2.toString(), _this.getRandom(24, 44) + "," + num2Top, {
                color: "#db2222",
                size: num2Size,
                name: "impact",
            });
            bmp.writeText(num3.toString(), _this.getRandom(48, 68) + "," + num3Top, {
                color: "#db2222",
                size: num3Size,
                name: "impact",
            });
            bmp.writeText(num4.toString(), _this.getRandom(72, 96 - num4Size) + "," + num4Top, {
                color: "#db2222",
                size: num4Size,
                name: "impact",
            });
            bmp.drawLine(_this.getRandom(0, 48) + "," + _this.getRandom(0, 40), _this.getRandom(48, 96) + "," + _this.getRandom(0, 40), "#db2222");
            bmp.drawLine(_this.getRandom(0, 48) + "," + _this.getRandom(0, 40), _this.getRandom(48, 96) + "," + _this.getRandom(0, 40), "#db2222");
            bmp.drawLine(_this.getRandom(0, 48) + "," + _this.getRandom(0, 40), _this.getRandom(48, 96) + "," + _this.getRandom(0, 40), "#db2222");
            var data = bmp.toDataUrl(BitmapFactory.OutputFormat.JPEG, 75);
            _this.imageUrl = data;
        });
    };
    CouponGetComponent.prototype.changeVerify = function () {
        this.showVerifyView();
    };
    return CouponGetComponent;
}());
__decorate([
    core_1.ViewChild("image"),
    __metadata("design:type", core_1.ElementRef)
], CouponGetComponent.prototype, "img", void 0);
CouponGetComponent = __decorate([
    core_1.Component({
        selector: "coupon-get",
        moduleId: module.id,
        providers: [coupon_service_1.CouponService],
        templateUrl: "./coupon-get.component.html",
        styleUrls: ["./coupon-get.common.css"],
    }),
    __metadata("design:paramtypes", [page_1.Page, coupon_service_1.CouponService, logger_service_1.Logger, router_1.Router, router_1.ActivatedRoute])
], CouponGetComponent);
exports.CouponGetComponent = CouponGetComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY291cG9uLWdldC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJjb3Vwb24tZ2V0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOztHQUVHO0FBQ0gsc0NBQXVFO0FBQ3ZFLGlEQUE4QztBQUM5QyxxREFBa0Q7QUFDbEQscUVBQWlFO0FBQ2pFLCtEQUFvRDtBQUNwRCwwQ0FBdUQ7QUFDdkQsMkRBQThEO0FBRzlELDZEQUF5RDtBQVF6RCxJQUFhLGtCQUFrQjtJQU83Qiw0QkFBb0IsSUFBVSxFQUFVLGFBQTRCLEVBQVUsTUFBYyxFQUFVLE1BQWMsRUFBVSxjQUE4QjtRQUF4SSxTQUFJLEdBQUosSUFBSSxDQUFNO1FBQVUsa0JBQWEsR0FBYixhQUFhLENBQWU7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQVUsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUFVLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUxySixnQkFBVyxHQUFXLEVBQUUsQ0FBQztRQUV4QixhQUFRLEdBQUcsWUFBWSxDQUFDO1FBQ3hCLFdBQU0sR0FBRyxFQUFFLENBQUM7SUFHcEIsQ0FBQztJQUVNLHFDQUFRLEdBQWY7UUFBQSxpQkFnQkM7UUFmQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7UUFDakMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFVBQUMsS0FBSztZQUM5QyxLQUFJLENBQUMsSUFBSSxHQUFHLElBQUksZUFBTSxDQUNwQixLQUFLLENBQUMsY0FBYyxFQUNwQixLQUFLLENBQUMsYUFBYSxFQUNuQixLQUFLLENBQUMsaUJBQWlCLEVBQ3ZCLEtBQUssQ0FBQyxlQUFlLEVBQ3JCLEtBQUssQ0FBQyxTQUFTLEVBQ2YsS0FBSyxDQUFDLFdBQVcsRUFDakIsS0FBSyxDQUFDLG1CQUFtQixFQUN6QixLQUFLLENBQUMsVUFBVSxFQUNoQixLQUFLLENBQUMscUJBQXFCLENBQUMs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QyxFQUFFLEVBQUUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsRUFDOUQsS0FBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxHQUFHLEtBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1lBQ25FLElBQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFDaEUsS0FBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRU0seUNBQVksR0FBbkI7UUFDRSxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUNILHlCQUFDO0FBQUQsQ0FBQyxBQTNIRCxJQTJIQztBQTFIcUI7SUFBbkIsZ0JBQVMsQ0FBQyxPQUFPLENBQUM7OEJBQWEsaUJBQVU7K0NBQUM7QUFEaEMsa0JBQWtCO0lBUDlCLGdCQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsWUFBWTtRQUN0QixRQUFRLEVBQUUsTUFBTSxDQUFDLEVBQUU7UUFDbkIsU0FBUyxFQUFFLENBQUMsOEJBQWEsQ0FBQztRQUMxQixXQUFXLEVBQUUsNkJBQTZCO1FBQzFDLFNBQVMsRUFBRSxDQUFDLHlCQUF5QixDQUFDO0tBQ3ZDLENBQUM7cUNBUTBCLFdBQUksRUFBeUIsOEJBQWEsRUFBa0IsdUJBQU0sRUFBa0IsZUFBTSxFQUEwQix1QkFBYztHQVBqSixrQkFBa0IsQ0EySDlCO0FBM0hZLGdEQUFrQiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IG11c2l3ZW4gb24gMjAxNy82LzE3LlxyXG4gKi9cclxuaW1wb3J0IHtDb21wb25lbnQsIEVsZW1lbnRSZWYsIE9uSW5pdCwgVmlld0NoaWxkfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQge1BhZ2V9IGZyb20gXCJ0bnMtY29yZS1tb2R1bGVzL3VpL3BhZ2VcIjtcclxuaW1wb3J0IHtDb3Vwb259IGZyb20gXCIuLi8uLi9zaGFyZWQvY291cG9uL2NvdXBvblwiO1xyXG5pbXBvcnQge0NvdXBvblNlcnZpY2V9IGZyb20gXCIuLi8uLi9zaGFyZWQvY291cG9uL2NvdXBvbi5zZXJ2aWNlXCI7XHJcbmltcG9ydCB7TG9nZ2VyfSBmcm9tIFwiLi4vLi4vc2VydmljZS9sb2dnZXIuc2VydmljZVwiO1xyXG5pbXBvcnQge0FjdGl2YXRlZFJvdXRlLCBSb3V0ZXJ9IGZyb20gXCJAYW5ndWxhci9yb3V0ZXJcIjtcclxuaW1wb3J0IEJpdG1hcEZhY3RvcnkgPSByZXF1aXJlKFwibmF0aXZlc2NyaXB0LWJpdG1hcC1mYWN0b3J5XCIpO1xyXG5pbXBvcnQge0ltYWdlfSBmcm9tIFwidG5zLWNvcmUtbW9kdWxlcy91aS9pbWFnZVwiO1xyXG5pbXBvcnQgS25vd25Db2xvcnMgPSByZXF1aXJlKFwidG5zLWNvcmUtbW9kdWxlcy9jb2xvci9rbm93bi1jb2xvcnNcIik7XHJcbmltcG9ydCB7R29vZHNJdGVtfSBmcm9tIFwiLi4vLi4vc2hhcmVkL2NvdXBvbi9nb29kcy1pdGVtXCI7XHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiBcImNvdXBvbi1nZXRcIixcclxuICBtb2R1bGVJZDogbW9kdWxlLmlkLFxyXG4gIHByb3ZpZGVyczogW0NvdXBvblNlcnZpY2VdLFxyXG4gIHRlbXBsYXRlVXJsOiBcIi4vY291cG9uLWdldC5jb21wb25lbnQuaHRtbFwiLFxyXG4gIHN0eWxlVXJsczogW1wiLi9jb3Vwb24tZ2V0LmNvbW1vbi5jc3NcIl0sXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBDb3Vwb25HZXRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xyXG4gIEBWaWV3Q2hpbGQoXCJpbWFnZVwiKSBwdWJsaWMgaW1nOiBFbGVtZW50UmVmO1xyXG4gIHB1YmxpYyBpbnB1dFZlcmlmeTogc3RyaW5nID0gXCJcIjtcclxuICBwcml2YXRlIGl0ZW06IENvdXBvbjtcclxuICBwcml2YXRlIGltYWdlVXJsID0gXCJyZXM6Ly9pY29uXCI7XHJcbiAgcHJpdmF0ZSB2ZXJpZnkgPSBcIlwiO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHBhZ2U6IFBhZ2UsIHByaXZhdGUgY291cG9uU2VydmljZTogQ291cG9uU2VydmljZSwgcHJpdmF0ZSBsb2dnZXI6IExvZ2dlciwgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlciwgcHJpdmF0ZSBhY3RpdmF0ZWRSb3V0ZTogQWN0aXZhdGVkUm91dGUpIHtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIHRoaXMucGFnZS5hY3Rpb25CYXJIaWRkZW4gPSB0cnVlO1xyXG4gICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZS5xdWVyeVBhcmFtcy5zdWJzY3JpYmUoKHBhcmFtKSA9PiB7XHJcbiAgICAgIHRoaXMuaXRlbSA9IG5ldyBDb3Vwb24oXHJcbiAgICAgICAgcGFyYW0uY2FwdHVyZV9zdGF0dXMsXHJcbiAgICAgICAgcGFyYW0uY291cG9uX2Ftb3VudCxcclxuICAgICAgICBwYXJhbS5jb3Vwb25fYmVnaW5fdGltZSxcclxuICAgICAgICBwYXJhbS5jb3Vwb25fZW5kX3RpbWUsXHJcbiAgICAgICAgcGFyYW0uY291cG9uX2lkLFxyXG4gICAgICAgIHBhcmFtLmNvdXBvbl9uYW1lLFxyXG4gICAgICAgIHBhcmFtLmNvdXBvbl9vcmRlcl9hbW91bnQsXHJcbiAgICAgICAgcGFyYW0uY291cG9uX3BpYyxcclxuICAgICAgICBwYXJhbS5jb3Vwb25fc3VycGx1c19hbW91bnQpO1xyXG4gICAgICB0aGlzLmxvZ2dlci5lcnJvcihwYXJhbS5jb3Vwb25fZW5kX3RpbWUpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLnNob3dWZXJpZnlWaWV3KCk7XHJcbiAgfVxyXG5cclxuICBwdWJsaWMgc3VibWl0KGV2ZW50KSB7XHJcbiAgICBjb25zdCBsaXN0ID0gW107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDIwOyBpKyspIHtcclxuICAgICAgbGlzdC5wdXNoKG5ldyBHb29kc0l0ZW0oMTIzLCBcIuS9oOWNluaIkeW9k+S9oOmdoueIseaIkeeahOmYv+eTpui+vueTpuWkp+eOi+Wkp+S8n+aJk+WujOWkp+aXoOWkmlwiLCBcImh0dHBzOi8vbmV3cmV0YWlsLmlza3lzaG9wLmNvbS91cGxvYWQvc3lzdGVtL3NlbGZfZ29vZHMvMjAxNi8wMS8yMi85MDIwM2QxZi1jOGRjLTQyYzYtYjhkMC0wMTdjN2NhNmQyMTguanBnX21pZGRsZS5qcGdcIiwgOTk4LjAwKSk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbXCIvaG9tZS8vY291cG9uU3VjY2Vzc1wiXSwge1xyXG4gICAgICBxdWVyeVBhcmFtczoge1xyXG4gICAgICAgIGxpc3Q6IEpTT04uc3RyaW5naWZ5KGxpc3QpLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICAvLyBpZiAodGhpcy5pbnB1dFZlcmlmeSA9PT0gdGhpcy52ZXJpZnkpIHtcclxuICAgIC8vICAgdGhpcy5jb3Vwb25TZXJ2aWNlLmdldENvdXBvbih0aGlzLml0ZW0uY291cG9uX2lkLnRvU3RyaW5nKCkpXHJcbiAgICAvLyAgICAgLnN1YnNjcmliZSgocmVzcG9uc2UpID0+IHtcclxuICAgIC8vICAgICAgIHN3aXRjaCAocmVzcG9uc2Uuc3RhdHVzKSB7XHJcbiAgICAvLyAgICAgICAgIGNhc2UgMTpcclxuICAgIC8vICAgICAgICAgICBicmVhaztcclxuICAgIC8vICAgICAgICAgY2FzZSAwOlxyXG4gICAgLy8gICAgICAgICAgIGFsZXJ0KFwi5LyY5oOg5Yi45bey5aSx5pWIXCIpO1xyXG4gICAgLy8gICAgICAgICAgIGJyZWFrO1xyXG4gICAgLy8gICAgICAgICBjYXNlIC0xOlxyXG4gICAgLy8gICAgICAgICAgIGFsZXJ0KFwi6LaF6L+H6aKG5Y+W5LiK6ZmQXCIpO1xyXG4gICAgLy8gICAgICAgICAgIGJyZWFrO1xyXG4gICAgLy8gICAgICAgICBjYXNlIC0yOlxyXG4gICAgLy8gICAgICAgICAgIGFsZXJ0KFwi5LyY5oOg5Yi45pWw6YeP5LiN6LazXCIpO1xyXG4gICAgLy8gICAgICAgICAgIGJyZWFrO1xyXG4gICAgLy8gICAgICAgICBjYXNlIC0zOlxyXG4gICAgLy8gICAgICAgICAgIGFsZXJ0KFwi5oKo55qE55So5oi3562J57qn5LiN5aSfXCIpO1xyXG4gICAgLy8gICAgICAgICAgIGJyZWFrO1xyXG4gICAgLy8gICAgICAgfVxyXG4gICAgLy8gICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgLy8gICAgICAgYWxlcnQoXCLnvZHnu5zplJnor69cIik7XHJcbiAgICAvLyAgICAgfSk7XHJcbiAgICAvLyB9IGVsc2Uge1xyXG4gICAgLy8gICBhbGVydChcIuivt+i+k+WFpeato+ehrueahOmqjOivgeeggVwiKTtcclxuICAgIC8vIH1cclxuXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgZ2V0UmFuZG9tKG1heDogbnVtYmVyLCBtaW46IG51bWJlcik6IG51bWJlciB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpICsgbWluKTtcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzaG93VmVyaWZ5VmlldygpIHtcclxuICAgIGNvbnN0IGJtcCA9IEJpdG1hcEZhY3RvcnkuY3JlYXRlKDk2LCA0MCk7XHJcbiAgICBjb25zdCBpbWFnZTIgPSB0aGlzLmltZy5uYXRpdmVFbGVtZW50IGFzIEltYWdlO1xyXG4gICAgYm1wLmRpc3Bvc2UoKCkgPT4ge1xyXG4gICAgICBibXAuZHJhd1JlY3Qoe3dpZHRoOiA5NiwgaGVpZ2h0OiA0MH0sIFwiMCwwXCIsIFwiI2ZmZmZmZlwiLCBcIiNmZmZmZmZcIik7XHJcbiAgICAgIE1hdGgucmFuZG9tKClcclxuICAgICAgY29uc3QgbnVtMSA9IHRoaXMuZ2V0UmFuZG9tKDAsIDkpO1xyXG4gICAgICBjb25zdCBudW0yID0gdGhpcy5nZXRSYW5kb20oMCwgOSk7XHJcbiAgICAgIGNvbnN0IG51bTMgPSB0aGlzLmdldFJhbmRvbSgwLCA5KTtcclxuICAgICAgY29uc3QgbnVtNCA9IHRoaXMuZ2V0UmFuZG9tKDAsIDkpO1xyXG4gICAgICBjb25zdCBudW0xU2l6ZSA9IHRoaXMuZ2V0UmFuZG9tKDUsIDI1KTtcclxuICAgICAgY29uc3QgbnVtMlNpemUgPSB0aGlzLmdldFJhbmRvbSg1LCAyNSk7XHJcbiAgICAgIGNvbnN0IG51bTNTaXplID0gdGhpcy5nZXRSYW5kb20oNSwgMjUpO1xyXG4gICAgICBjb25zdCBudW00U2l6ZSA9IHRoaXMuZ2V0UmFuZG9tKDUsIDI1KTtcclxuICAgICAgY29uc3QgbnVtMVRvcCA9IHRoaXMuZ2V0UmFuZG9tKG51bTFTaXplICsgMTAsIDQwKTtcclxuICAgICAgY29uc3QgbnVtMlRvcCA9IHRoaXMuZ2V0UmFuZG9tKG51bTJTaXplICsgMTAsIDQwKTtcclxuICAgICAgY29uc3QgbnVtM1RvcCA9IHRoaXMuZ2V0UmFuZG9tKG51bTNTaXplICsgMTAsIDQwKTtcclxuICAgICAgY29uc3QgbnVtNFRvcCA9IHRoaXMuZ2V0UmFuZG9tKG51bTRTaXplICsgMTAsIDQwKTtcclxuICAgICAgdGhpcy52ZXJpZnkgPSBudW0xLnRvU3RyaW5nKCkgKyBudW0yLnRvU3RyaW5nKCkgKyBudW0zLnRvU3RyaW5nKCkgKyBudW00LnRvU3RyaW5nKCk7XHJcbiAgICAgIGJtcC53cml0ZVRleHQobnVtMS50b1N0cmluZygpLCB0aGlzLmdldFJhbmRvbSgwLCAyMCkgKyBcIixcIiArIG51bTFUb3AsIHtcclxuICAgICAgICBjb2xvcjogXCIjZGIyMjIyXCIsXHJcbiAgICAgICAgc2l6ZTogbnVtMVNpemUsXHJcbiAgICAgICAgbmFtZTogXCJpbXBhY3RcIixcclxuICAgICAgfSk7XHJcbiAgICAgIGJtcC53cml0ZVRleHQobnVtMi50b1N0cmluZygpLCB0aGlzLmdldFJhbmRvbSgyNCwgNDQpICsgXCIsXCIgKyBudW0yVG9wLCB7XHJcbiAgICAgICAgY29sb3I6IFwiI2RiMjIyMlwiLFxyXG4gICAgICAgIHNpemU6IG51bTJTaXplLFxyXG4gICAgICAgIG5hbWU6IFwiaW1wYWN0XCIsXHJcbiAgICAgIH0pO1xyXG4gICAgICBibXAud3JpdGVUZXh0KG51bTMudG9TdHJpbmcoKSwgdGhpcy5nZXRSYW5kb20oNDgsIDY4KSArIFwiLFwiICsgbnVtM1RvcCwge1xyXG4gICAgICAgIGNvbG9yOiBcIiNkYjIyMjJcIixcclxuICAgICAgICBzaXplOiBudW0zU2l6ZSxcclxuICAgICAgICBuYW1lOiBcImltcGFjdFwiLFxyXG4gICAgICB9KTtcclxuICAgICAgYm1wLndyaXRlVGV4dChudW00LnRvU3RyaW5nKCksIHRoaXMuZ2V0UmFuZG9tKDcyLCA5NiAtIG51bTRTaXplKSArIFwiLFwiICsgbnVtNFRvcCwge1xyXG4gICAgICAgIGNvbG9yOiBcIiNkYjIyMjJcIixcclxuICAgICAgICBzaXplOiBudW00U2l6ZSxcclxuICAgICAgICBuYW1lOiBcImltcGFjdFwiLFxyXG4gICAgICB9KTtcclxuICAgICAgYm1wLmRyYXdMaW5lKHRoaXMuZ2V0UmFuZG9tKDAsIDQ4KSArIFwiLFwiICsgdGhpcy5nZXRSYW5kb20oMCwgNDApLFxyXG4gICAgICAgIHRoaXMuZ2V0UmFuZG9tKDQ4LCA5NikgKyBcIixcIiArIHRoaXMuZ2V0UmFuZG9tKDAsIDQwKSwgXCIjZGIyMjIyXCIpO1xyXG4gICAgICBibXAuZHJhd0xpbmUodGhpcy5nZXRSYW5kb20oMCwgNDgpICsgXCIsXCIgKyB0aGlzLmdldFJhbmRvbSgwLCA0MCksXHJcbiAgICAgICAgdGhpcy5nZXRSYW5kb20oNDgsIDk2KSArIFwiLFwiICsgdGhpcy5nZXRSYW5kb20oMCwgNDApLCBcIiNkYjIyMjJcIik7XHJcbiAgICAgIGJtcC5kcmF3TGluZSh0aGlzLmdldFJhbmRvbSgwLCA0OCkgKyBcIixcIiArIHRoaXMuZ2V0UmFuZG9tKDAsIDQwKSxcclxuICAgICAgICB0aGlzLmdldFJhbmRvbSg0OCwgOTYpICsgXCIsXCIgKyB0aGlzLmdldFJhbmRvbSgwLCA0MCksIFwiI2RiMjIyMlwiKTtcclxuICAgICAgY29uc3QgZGF0YSA9IGJtcC50b0RhdGFVcmwoQml0bWFwRmFjdG9yeS5PdXRwdXRGb3JtYXQuSlBFRywgNzUpO1xyXG4gICAgICB0aGlzLmltYWdlVXJsID0gZGF0YTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcHVibGljIGNoYW5nZVZlcmlmeSgpIHtcclxuICAgIHRoaXMuc2hvd1ZlcmlmeVZpZXcoKTtcclxuICB9XHJcbn1cclxuXHJcbiJdfQ==